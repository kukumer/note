[TOC]
# 绪论
## 课程介绍
教师 王晓迪

邮箱：wangxiaodi_8@163.com

课程研究对象：多维随机向量
> 什么是多维随机向量

课程内容：
1. 基础理论
2. 分类方法
3. 多变量分析（数据结构简化）
4. 两组变量的相关分析

> 重点是前三部分

课程特点：多元统计方法和计算机软件（SPSS）结合

考核方法：
平时成绩：30%（作业，出勤）
期末考试：70%（闭卷考试）

## 研究内容：
### 简化数据结构（降维问题）

1. 相互依赖的变量的变量变成互不相关
2. 把高维空间的数据投影到低维空间

> 主成分分析、因子分析和对应分析等 

### 分类与判别（归类问题）

按照相似程度进行分类（或归类）
> 聚类分析和判别分析

### 变量间的相互联系

1. 相互依赖关系，探寻一个或几个变量的变化是否依赖于另一些变量的变化，建立变量间的定量关系式，用于预测或控制——回归分析
2. 分析两组变量之间的相互关系——典型相关分析等
3. 两组变量间的相互依赖关系——偏最小二乘法回归分析

### 多元数据的统计推断

参数估计和假设检验
> 特别是多元正态分布的均值向量和协差阵的估计和假设检验问题

### 多元统计分析的理论基础

多维随机向量及多维正态随机向量，及由此定义的各种多元统计量，推导他们的分布并研究性质，研究他们的抽样分布理论

## 应用举例
（1）主成分分析在学生学习成绩排序中的应用
（2）社会科学中通过青少年的行为指标预测青少年犯罪的可能性
（3）文学领域对《红楼梦》的著作权进行研究

# 多元正态分布的参数估计
## 定义
### （多元）随机向量
```math
将p个随机变量X_1,X_2,...,X_p的整体称为p维随机向量，记为X = (X_1,X_2,...,X_p)'
```
> （这个概念可以再斟酌斟酌）

### 分布函数(跟概率论一致)：
<b>连续型：</b>
```math
设X = (X_1,X_2,...,X_p)'是P维随机向量，它的多元分布函数定义为：\\
F(x) \overset{△}{=} F,(X_1,X_2,...X_p)=P(X_1 < x_1,X_2 < x_2,...X_p < x_p)\\
记为X \backsim F(x),其中x = (x_1,x_2,...,x_p)'\in R^p,R^p表示p维欧氏空间。
```
> 多维随机向量的统计特征可以用它的分布函数来完整地描述

> 三角形下加=是什么意思

<b>离散型：</b>
```math
设X = (X_1,X_2,...X_p)'是p维随机向量，若存在有限个或可列个p维数向量x_1,x_2,...,\\记P(X = x_k) = p_k,(k = 1,2,...)且满足p_1+p_2+...=1,则称X为离散型随机向量，称P(X = x_k) = p_k,(k=1,2,...)为X的概率分布
```

### 密度函数（跟概率论一致）
```math
设X \sim F(x)\overset{△}{=}F(x_1,x_2,...x_p),若存在一个非负函数f(x_1,x_2,...,x_p),使得对一切x = (x_1,x_2,...x_p)'/in R^p有:  

F(x)\overset{△}{=}F(x_1,x_2,...x_p) =  \int^{x_1}_{-\infin}...\int^{x_p}_{-\infin}f(t_1,t_2,...,t_p)dt_1...dt_p

则称X为连续型随机变量，称f(x_1,x_2,...,x_p)为分布密度函数，简称为密度函数或分布密度。
```
#### 证明函数为密度函数
只需证明满足两个条件:  
（1）在各点密度函数取值大于等于0
```math
f(x_1,x_2,...,x_p)\ge 0,\forall(x_1,x_2,...x_p)'\in R^p
```
（2）在整个实数域上积分的值为1
```math
\int^{+\infin}_{-\infin}...\int^{+\infin}_{-\infin}f(t_1,t_2,...,t_p)dt_1...dt_p = 1
```
> 离散型随机向量的统计性质可由它的概率分布完全确定，连续型随机向量的统计性质可由它的分布密度完全确定。
![image](45A7FFE42EBD4290B07EB2E47CCD62D4)

### 边缘分布
```math
设X=(X_1,X_2,...X_p)'是p维随机向量，称由它的取q个维度(<q)个分量组成的子向量

X^{(i)} = (X_{i_1},X_{i_2},...,X_{i_q})'

当X的分布函数是F(x_1,x_2,...,x_p)时，X^{(1)}的分布函数即边缘分布函数为：

F_1(x_1,x_2,...,x_q) = P(X_1\le x_1,...,X_q\le x_q) \\
= P(X_1\le x_1,...,X_q\le x_q,X_{q+1}\le\infin,...,X_p \le \infin)\\
= F(x_1,x_2,...,x_q,\infin,...,\infin)
```

### 边缘密度函数与独立性
```math
当X有分布密度f(x_1,x_2,...,x_p)时，则X^{(1)}也有分布密度，即边缘密度函数为：

f_1(x_1,x_2,...,x_q) = \int^{+\infin}_{-\infin}...\int^{+\infin}_{-\infin}f(x_1,x_2,...,x_p)dx_{q+1}...dx_p
```
> 相当于积分掉了未被选进来的部分（用单变量来记，X1的密度函数是关于X1的函数）留下来了剩下的参数

#### 独立性
```math
若p个随机变量X_1,X_2,X_p的联合分布等于各自的边缘分布的乘积，则称X_1,X_2,...X_p是相互独立的。
````
#### 求取边缘密度函数以及证明变量之间是否独立
![image](82298E9D7FFB4244922F79369FB0458E)

![image](C8E17643E2FE486E84969B41C1C0F425)

注意：
- 比较容易出错的是分段函数要分段讨论   
- 由各个变量之间相互独立可以推导任何两变量独立，==但是反之不成立==   
- 不具有独立性是数据降维的前提

## 随机向量的数字特征
### 均值（向量）或数学期望

#### 均指向量的性质
```math
E(AX)=AE(X)\\
E(AXB)=AE(X)B\\
E(AX+BY)=AE(X)+BE(Y)\\
其中，X、Y为随机向量，A、B为大小适合运算的常数矩阵。
```

### 方差或协差阵
```math
D(X) \overset{△}{=} E(X-E(X))(X-E(X))'=\Sigma=(\delta_{ij})_{p*p}
```
![image](79352016D18D4FFC9FCACE00D7A11164)
```math
Cov(X,Y) = E(X-E(x))(Y-E(Y)) 
```
![image](155AD3C26ED54150AEC29E6245E4CAB5)

#### 协方差阵性质
```math
(1) D(X+a) = D(X)\\
(2) D(AX) = AD(X)A' = A\Sigma A'\\
(3) Cov(AX,BY) = ACov(X,Y)B'\\
(4) 设X为n维随机向量，期望和协方差存在，及\mu = E(X),\Sigma = D(X),A为n*n常数阵，则E(X'AX)=tr(A\Sigma)+\mu' A\mu\\
(5)任何的多维随机向量，其协方差阵\Sigma都是对称阵，同时总是非负定（半正定）的。大多数情况下是正定的。
```
> 矩阵正定：https://baike.baidu.com/item/%E6%AD%A3%E5%AE%9A%E7%9F%A9%E9%98%B5/11030459?fr=aladdin

> 正定的判断方法：  
（1）求出A的所有特征值。若A的特征值均为正数，则A是正定的；若A的特征值均为负数，则A为负定的。   
（2）计算A的各阶主子式。若A的各阶主子式均大于零，则A是正定的；若A的各阶主子式中，奇数阶主子式为负，偶数阶为正，则A为负定的。

#### 标准化&相关系数
- 标准化：在数据处理中，为了克服由于指标的量纲不同对统计分析结果带来的影响，往往在使用各种统计分析，常需要将每个指标“标准化”
```math
X^*_j = \frac {X_j-E(X_j)} {\sqrt{D(X_j)}}
```
- 相关系数
```math
\rho_{ij} = \frac {Cov(X_i,X_j)}  {\sqrt{D(X_i)}\sqrt{D(X_j)}} = \frac {\sigma_{ij}}{\sqrt{\sigma_{ii}}\sqrt{\sigma_{jj}}}
```
>  标准化后的变量的协方差阵等价于相关系数矩阵

即：
```math
Cov(X^*_i,X^*_j) = \rho_{ij}
```
证明：
```math
X^* = (X^*_1,X^*_2,...,X^*_p)'\\
令，C = diag(\sigma_{11},\sigma_{22},...,\sigma_{pp})，有：\\
X^* = C^{-1}(X-E(X))\\
那么，标准化后的随机向量X^*均指和协差阵分别为：\\
E(X^*) = E[C^{-1}(X-E(X))] = C^{-1}E[(X - E(X))] = 0 

D(X^*) = D[C^{-1}(X-E(X))] = C^{-1}D[(X-E(X))]C^{-1}\\
= C^{-1}D(X)C^{-1} = C^{-1}\varSigma C^{-1}
```
## 多元正态分布
### 定义
```math
若p维随机向量X = (X_1,X_2,...,X_p)'的密度函数为：\\
f(x_1,x_2...x_P) = \frac {1} {2\pi^{p/2}|\varSigma|^{1/2}}exp[\frac {1}{2}(x-\mu)'\varSigma^{-1}(x-\mu)]\\
其中x = (x_1,x_2,...x_p)',\mu是p维向量，\varSigma是p阶正定阵。\\X服从p元正态分布，也称X为p维正态随机向量，简记为X\sim N_p(\mu,\varSigma)\\显然当p = 1时，即为一元正态密度函数。

\\
定理2.1 设X \sim N_p(\mu,\varSigma),则有E(X) = \mu,D(X) = \varSigma\\
这个定理将多元正太分布的参数\mu和\varSigma赋予了明确的统计意义
```

> 理清这里的逻辑线条，从一元正态分布的形式 -> 多元正态分布的形式 -> 证明其中的参数的含义 

### 性质
```math
（1）若X = (X_1,X_2,...,X_p)' \sim N_p(\mu,\varSigma),\varSigma是对角阵，则X_1,X_2,...X_p相互独立。\\
（2）若X \sim N_p(\mu,\varSigma)，A为s*p阶常数阵，d为s维常数向量，则：\\
AX + d \sim N_s(A\mu+d,A\varSigma A')\\
即正态随机向量的线性函数还是正态的\\
（3）若X\sim N_p(\mu,\varSigma)，将X,\mu,\Sigma作如下剖分
```
![image](39D09346F60E4824A9AC637FB9DD8805)

补充：
- 性质（1）表明在多元正态分布每一维都是正态的，如果某个数据列不是正态分布，整体不能用正态的方法来做。比如说可以把某个分量的n个样本值作成直方图，如果断定不呈正态分布，则可断定总体也不是正态分布。
- 任意两个子向量是不相关的，那么两者是独立的，在多元正态分布中，不相关与独立是等价的。
- 多元正态分布的任何边缘分布正态分布，但是反之不成立。虽然拆分之后仍然是子集仍然是多元正态分布。

> PPT上的例2.4好好演算和斟酌

## 多元正态分布的参数估计
之前讲的都是总体的性质，从这里开始讲==样本==的

对于多元样本的数字特征进行区间估计很难，一般是做点估计

### 多元样本的数字特征
```math
设X_{(1)},X_{(2)},...,X{(n)}来自p元总体的样本，其中X_{(a)} = (X_{a1},X_{a2},...,X_{(ap)})',a = 1,2,...,n。
```

1. 样本均值向量
```math
\hat{\mu} = \bar{X} = \frac{1}{n}\sum^n_{a=1}X_{(a)} = (\bar X_1,\bar X_2,...,\bar X_p)'
```

2. 样本离差阵
```math
S_{p*p} = \sum^n_{a=1}(X_{(a)}-\bar X)(X_{(a)}-\bar X)' = (s_{ij})_p*p
```

3. 样本协差阵
```math
V_{p*p} = \frac {1}{n}S =\frac {1}{n}  \sum^n_{a=1}(X_{(a)}-\bar X)(X_{(a)}-\bar X)' = (v_{ij})_p*p 
```

4. 样本相关阵
```math
\hat{R_{p*p}} = [r_{ij}]_{p*p}\\
其中r_{ij} = \frac{v_{ij}}{\sqrt{v_{ii}}\sqrt{v_{jj}}} = \frac{s_{ij}}{\sqrt{s_{ii}}\sqrt{s_{jj}}} 

```

估计值属于极大似然估计值

wishart分布

# 多元正态分布均值向量和协差阵的检验
研究内容：
均指和方差是否相等的检验

## 正态性的检验

###  偏度峰度正态性检验

在正态性检验中，偏度峰度正态性检验统计量原理清晰、计算简单，通常被首选用来作为正态性检验统计量。

<h4>检验原理</h4>

正态分布的偏度和峰度均为0。其中偏度定义为$b_s = \frac {E(X-EX)^3}{D(X)^{3/2}}$，峰度定义为$k = \frac {E(X-EX)^4}{D(X)^2}-3$ 。

> 值得注意的是在现代统计软件中，有些软件在定义峰度时没有减3，造成了正态分布的峰度就是3

在拥有不同先验信息的前提下，构造不同的检验统计量，详细见[百度百科](https://baike.baidu.com/item/正态性检验)

> 先验信息指的是获得样本的试验之前，获得的经验和历史资料

### W检验

W检验是一种基于相关性的算法，它常用于检验样本容量为8~50。计算可得到一个相关系数，它越接近1就表明数据和正态分布拟合得越好。

### K-S检验

K-S基于累积分布函数，用以检验一个经验分布是否符合某种理论分布或比较两个经验分布之间是否存在显著的差异。既可以做单样本的，也可以做多样本的。

### QQ图

![1570516144199](D:\picture\1570516144199.png)

![1570516168949](D:\picture\1570516168949.png)

[多因素方差分析](https://jingyan.baidu.com/article/ab69b270686fe52ca6189f61.html)

[使用SPSS进行多元正态总体的均值、方差检验](https://jingyan.baidu.com/article/ca41422fc227471eaf99ed56.html)

[协变量](http://blog.sina.com.cn/s/blog_b43ab1510102xoiy.html)

